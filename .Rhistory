if (!require("tidyverse")) install.packages("tidyverse"); library("tidyverse")
if (!require("ggplot2")) install.packages("ggplot2"); library("ggplot2")
if (!require("Hmisc")) install.packages("Hmisc"); library("Hmisc")
if (!require("PupillometryR")) install.packages("PupillometryR"); library("PupillometryR")
if (!require("plyr")) install.packages("plyr"); library("plyr")
if (!require("ape")) install.packages("ape"); library("ape")
if (!require("geiger")) install.packages("geiger"); library("geiger")
if (!require("diversitree")) install.packages("diversitree"); library("diversitree")
### create directory for pgls models
# check if dir exists
dir_check = dir.exists(paths="4_graphics")
# create dir if not created yet
if (dir_check == FALSE){
dir.create(path= "4_graphics")
}
### phylogenetic tree
mcc_phylo = read.tree("0_data/pruned_mcc_phylo.nwk")
### loading trait data
trait_mtx = read.table("0_data/trait_matrix.csv",
h=T, sep=",", na.strings = "na")
### loading trait data
flower_mtx = read.table("0_data/flower_trait_matrix.csv",
h=T, sep=",", na.strings = "na")
### importing habita range
habitat_range = readRDS("1_habitat_results/habitat_range.RDS")
### n tips and nodes
n_tips = Ntip(mcc_phylo)
n_inner_nodes = mcc_phylo$Nnode
### sampled species
sampled_sp = unique(trait_mtx$species)
### habitat states
spp_states = habitat_range$range
names(spp_states) =  habitat_range$species
## state colors
state_cols = c("forestgreen", "brown","darkorange")
names(state_cols) = levels(habitat_range$range)
### flower size per species
flower = flower_mtx %>%
#group_by(species) %>%
drop_na()
### flower size per species
flower = flower_mtx %>%
#group_by(species) %>%
drop_na() %>%
reframe(
flower_size = median(style_height, na.rm=T)
)
View(flower)
View(flower_mtx)
### flower size per species
flower = flower_mtx %>%
select(species, style_height) %>%
#group_by(species) %>%
drop_na() %>%
reframe(
flower_size = style_height
)
View(flower_mtx)
View(flower)
