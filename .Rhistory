if (!require("tidyverse")) install.packages("tidyverse"); library("tidyverse")
if (!require("ggplot2")) install.packages("ggplot2"); library("ggplot2")
if (!require("ape")) install.packages("ape"); library("ape")
if (!require("geiger")) install.packages("geiger"); library("geiger")
if (!require("phytools")) install.packages("phytools"); library("phytools")
if (!require("nlme")) install.packages("nlme"); library("nlme")
### loading phylogenetic tree
mcc_phylo = read.tree("0_data/pruned_mcc_phylo.nwk")
### counting pruned phylognetic trees
n_phylo = length(list.files("0_data/pruned_phylos"))
### loading trait data
trait_mtx = read.table("0_data/trait_matrix.csv",
h=T, sep=",", na.strings = "na")
### loading occurrence count per domain
habitat_range = readRDS("1_habitat_results/habitat_range.RDS")
### sampled species
sampled_sp = unique(trait_mtx$species)
### defininf states
spp_states = habitat_range$range
names(spp_states) = habitat_range$species
View(trait_mtx)
pi
### trait values per species
spp_traits = trait_mtx %>%
mutate(
leaf.size = leaf_length_cm ,
inflorescence.size = inflorescence_length_cm
) %>%
group_by(species) %>%
reframe(
leaf.size =  median(leaf.size, na.rm=T),
inflorescence.size = median(inflorescence.size, na.rm= T),
n = n()
) %>%
left_join(habitat_range, by = "species")
View(spp_traits)
plot(x = leaf.size,
y = infloresnce.size,
data = spp_traits)
View(trait_mtx)
spp_traits[["leaf.size"]]
plot(x = spp_traits[["leaf.size"]],
y = spp_traits[["infloresnce.size"]],
)
plot(x = spp_traits[["leaf.size"]],
y = spp_traits[["infloresnce.size"]]
)
plot(spp_traits[["leaf.size"]],
spp_traits[["infloresnce.size"]]
)
spp_traits[["leaf.size"]]
plot(infloresnce.size~leaf.size,
data - spp_traits
)
plot(infloresnce.size~leaf.size,
data = spp_traits
)
plot(inflorescence.size~leaf.size,
data = spp_traits
)
if (!require("geiger")) install.packages("geiger"); library("geiger")
if (!require("phytools")) install.packages("phytools"); library("phytools")
miconia = spp_traits %>%
select(species, leaf.size, inflorescence.size)
miconia
write.table(miconia, "miconia.csv", h = T, quote= F, row.names = F)
write.table(miconia, "miconia.csv", quote= F, row.names = F)
if (!require("tidyverse")) install.packages("tidyverse"); library("tidyverse")
if (!require("ggplot2")) install.packages("ggplot2"); library("ggplot2")
if (!require("ape")) install.packages("ape"); library("ape")
if (!require("geiger")) install.packages("geiger"); library("geiger")
if (!require("phytools")) install.packages("phytools"); library("phytools")
if (!require("nlme")) install.packages("nlme"); library("nlme")
### loading phylogenetic tree
mcc_phylo = read.tree("0_data/pruned_mcc_phylo.nwk")
### counting pruned phylognetic trees
n_phylo = length(list.files("0_data/pruned_phylos"))
### loading trait data
trait_mtx = read.table("0_data/trait_matrix.csv",
h=T, sep=",", na.strings = "na")
### loading occurrence count per domain
habitat_range = readRDS("1_habitat_results/habitat_range.RDS")
### sampled species
sampled_sp = unique(trait_mtx$species)
### defininf states
spp_states = habitat_range$range
names(spp_states) = habitat_range$species
### trait values per species
spp_traits = trait_mtx %>%
mutate(
seed_wei_mg = fruit_weight_mg/seed_number,
) %>%
group_by(species) %>%
reframe(
sla =  median(leaf_sla, na.rm=T),
seed_mass = median(seed_wei_mg),
n = n()
) %>%
left_join(habitat_range, by = "species")
View(spp_traits)
### trait values per species
spp_traits = trait_mtx %>%
group_by(species) %>%
reframe(
sla =  1/median(leaf_sla, na.rm=T),
seed.number = median(seed_number, na.rm=T),
n = n()
) %>%
left_join(habitat_range, by = "species")
### trait values per species
spp_traits = trait_mtx %>%
group_by(species) %>%
reframe(
lma =  1/median(leaf_sla, na.rm=T),
seed.number = median(seed_number, na.rm=T),
n = n()
) %>%
left_join(habitat_range, by = "species")
miconia = spp_traits %>%
select(species, lma, seed.mass)
### trait values per species
spp_traits = trait_mtx %>%
group_by(species) %>%
reframe(
lma =  1/median(leaf_sla, na.rm=T),
seed.number = median(seed_number, na.rm=T),
n = n()
) %>%
left_join(habitat_range, by = "species")
miconia = spp_traits %>%
select(species, lma, seed.number)
miconia
plot(seed.number~lma,
data = miconia)
plot(log(seed.number)~lma,
data = miconia)
View(trait_mtx)
### trait values per species
spp_traits = trait_mtx %>%
group_by(species) %>%
reframe(
plant.size =  median(plant_height_m, na.rm=T),
seed.number = median(seed_number, na.rm=T),
n = n()
) %>%
left_join(habitat_range, by = "species")
plot(log(seed.number)~plant.size,
data = miconia)
### trait values per species
spp_traits = trait_mtx %>%
group_by(species) %>%
reframe(
plant.size =  median(plant_height_m, na.rm=T),
seed.number = median(seed_number, na.rm=T),
n = n()
) %>%
left_join(habitat_range, by = "species")
miconia = spp_traits %>%
select(species, plant.size, seed.number)
plot(log(seed.number)~plant.size,
data = miconia)
plot(seed.number~plant.size,
data = miconia)
plot(log(seed.number)~log(plant.size),
data = miconia)
miconia
### trait values per species
spp_traits = trait_mtx %>%
group_by(species) %>%
reframe(
plant.size =  median(plant_height_m, na.rm=T),
seed.number = round(median(seed_number, na.rm=T)),
n = n()
) %>%
left_join(habitat_range, by = "species")
miconia = spp_traits %>%
select(species, plant.size, seed.number)
plot(log(seed.number)~log(plant.size),
data = miconia)
miconia
write.table(miconia, "miconia.csv", sep =",", quote= F, row.names = F)
if (!require("tidyverse")) install.packages("tidyverse"); library("tidyverse")
if (!require("ggplot2")) install.packages("ggplot2"); library("ggplot2")
if (!require("ape")) install.packages("ape"); library("ape")
if (!require("geiger")) install.packages("geiger"); library("geiger")
if (!require("phytools")) install.packages("phytools"); library("phytools")
if (!require("nlme")) install.packages("nlme"); library("nlme")
### loading phylogenetic tree
mcc_phylo = read.tree("0_data/pruned_mcc_phylo.nwk")
### counting pruned phylognetic trees
n_phylo = length(list.files("0_data/pruned_phylos"))
### loading trait data
trait_mtx = read.table("0_data/trait_matrix.csv",
h=T, sep=",", na.strings = "na")
### loading occurrence count per domain
habitat_range = readRDS("1_habitat_results/habitat_range.RDS")
### sampled species
sampled_sp = unique(trait_mtx$species)
### defininf states
spp_states = habitat_range$range
names(spp_states) = habitat_range$species
### trait values per species
spp_traits = trait_mtx %>%
group_by(species) %>%
reframe(
leaf.size =  median(leaf_length_cm, na.rm=T),
inflor.size = median(inflorescence_length_cm, na.rm=T),
n = n()
) %>%
left_join(habitat_range, by = "species")
miconia %>%
select(species, leaf.size, inflore.size)
miconia = spp_traits%>%
select(species, leaf.size, inflore.size)
miconia = spp_traits%>%
select(species, leaf.size, inflor.size)
write.table(miconia, "miconia2.csv", sep = ",", quote = F, row.names = F)
